delta $"TABLE_1_LOC"
model Table1 = {
  id: string,
  name: string,
}

delta $"TABLE_2_LOC"
model Table2 = {
  id: string,
  tid: string,
  value: string,
}

model RELT_0 = Table2 where value > 0 and tid != ""

model RELT_1 = RELT_0 sort value asc

model RELT_2 = RELT_1 over tid

model RELT_3 = RELT_2 with {
  children: collect,
  count: count,
  maxValue: value.max,
  constant: 5,
}

delta $"TABLE_3_LOC"
model Table3 = RELT_3 where count > 10

delta $"TABLE_4_LOC"
model Table4 = Table1 left join Table3