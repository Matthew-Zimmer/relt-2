delta $"TABLE_1_LOC"
model Table1 = {
  id: string,
  name: string,
}

delta $"TABLE_2_LOC"
model Table2 = {
  id: string,
  tid: string,
  value: string,
}

delta $"TABLE_3_LOC"
model Table3 = Table2
  | where Table3.value > 0 and Table3.tid != ""
| sort Table3.value asc
| over Table3.tid
| {
  children: Table3.collect,
  count: Table3.count,
  maxValue: value.max,
  constant: 5,
}
| where Table3.count > 10

delta $"TABLE_4_LOC"
model Table4 = Table1 left join Table3